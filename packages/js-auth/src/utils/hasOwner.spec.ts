import { jwtDecode } from "../jwtDecode.js"
import { hasOwner } from "./hasOwner.js"

describe("hasOwner", () => {
  it("should return false when the provided payload does not have an 'owner'", () => {
    const decodedJWT = jwtDecode(accessTokenWithoutOwner)
    expect(hasOwner(decodedJWT.payload)).toBe(false)
  })

  it("should return true when the provided payload has an 'owner'", () => {
    const decodedJWT = jwtDecode(accessTokenWithOwner)
    expect(hasOwner(decodedJWT.payload)).toBe(true)
  })
})

const accessTokenWithoutOwner =
  "eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsImtpZCI6IjliN2JiZmVlMzQzZDVkNDQ5ZGFkODhmMjg0MGEyZTM3YzhkZWFlZTg5NjM4MGQ1ODA2YTc4NWVkMWQ1OTc5ZjAifQ.eyJvcmdhbml6YXRpb24iOnsiaWQiOiJPblZOcUZPTUpuIiwic2x1ZyI6ImRyb3AtaW4tanMiLCJlbnRlcnByaXNlIjp0cnVlLCJyZWdpb24iOiJldS13ZXN0LTEifSwiYXBwbGljYXRpb24iOnsiaWQiOiJkTm5XbWl4eEtHIiwiY2xpZW50X2lkIjoia3VTS1BiZUtiVTlMRzlMam5kemllS1dSY2ZpWEZ1RWZPME9ZSFhLSDlKOCIsImtpbmQiOiJzYWxlc19jaGFubmVsIiwicHVibGljIjp0cnVlfSwibWFya2V0Ijp7ImlkIjpbIkJvd2RHaHdYZGoiXSwic3RvY2tfbG9jYXRpb25faWRzIjpbIkRuZ2VwdU5tT2siLCJLR3lPanV5S1hNIl0sImdlb2NvZGVyX2lkIjpudWxsLCJhbGxvd3NfZXh0ZXJuYWxfcHJpY2VzIjpmYWxzZX0sInNjb3BlIjoibWFya2V0OmNvZGU6dXNhIiwiZXhwIjoxNzI3Mzg2NzA2LCJ0ZXN0Ijp0cnVlLCJyYW5kIjowLjMzNTg3Njk5NDMxMjc4NzA2LCJpYXQiOjE3MjczNzk1MDYsImlzcyI6Imh0dHBzOi8vYXV0aC5jb21tZXJjZWxheWVyLmlvIn0.aiNjUiX1U0SpLGsVMkQsmDsAvdZysK_waVBtIdcJyXhA9jppmlLuvm9oY6EQbpRachBMcj3I6Hn5R0nI4vo-IAJY4DrYSWfCmiDceWhmrkfEMNk3eMGn74stMbN_B1tlCOTk_wB6_uLEgdxGeelZk2aY2J_VztYqxzNCuOPqX95qESdTqwYrgj7Iop9XeCqwbwKKo6mVn-k0ktdvHirCrv40xTK3bVEDOep5_kXcjaYLez4vijy06_zGlh5BB8GCelD082VJ_ZoIih2FFBuACIFG5usRN7ifEnvNJT1SbZom3JfvwRIZfejfl0S_l3EYqaVbNPAJ_Ia4vdY2LKj65XCrXFP6sEV26fg9z76kWvxW81hB2Bm43jrdYsAJ1CbbS6j4xqH6ZxDxTKc99G9EClgLqRnaDkIGRTKP9PINbtKfElT_NlcN7cBonCZ5y_2iIZqRTlLiaQLq2vWJS9TkqcKVDfHNjrhiz_T3ETR34_anBiLf8bx9mOuQYS4jbTGmcWV7mXEXs3yY2HTPMNOlB-tT7Ddy-xLfCCuiHU5Pt7_D78we8Rnh4pn5Xh4m8QRBJPbSj4UQ5rBgt0Fc_dt4QQ6-nRlC7P4rol-B-Wc8ZMOb8qp8Rieto-_bNJO1eBSvCgR4T1PQ0VhLC8OQU0hQynR57z2rSfgGwJMx9rHtkvE"

const accessTokenWithOwner =
  "eyJhbGciOiJSUzUxMiIsInR5cCI6IkpXVCIsImtpZCI6ImFiYTRjYzYyOGQxZmNlM2ZiOTNhM2VlNTU4MjZlNDFjZmFmMThkYzJkZmYzYjA3MjIyNzQwMzgwZTkxOTlkNWQifQ.eyJvcmdhbml6YXRpb24iOnsiaWQiOiJlbldveEZNT25wIiwic2x1ZyI6InRoZS1ibHVlLWJyYW5kLTMiLCJlbnRlcnByaXNlIjpmYWxzZSwicmVnaW9uIjoiZXUtd2VzdC0xIn0sImFwcGxpY2F0aW9uIjp7ImlkIjoibkdWcWFpRVlOQSIsImtpbmQiOiJzYWxlc19jaGFubmVsIiwicHVibGljIjp0cnVlfSwibWFya2V0Ijp7ImlkIjpbIkJqeHJKaHltbE0iXSwic3RvY2tfbG9jYXRpb25faWRzIjpbInhHWEJYdXJETUUiLCJkTXFYeXVWVmtOIl0sImdlb2NvZGVyX2lkIjpudWxsLCJhbGxvd3NfZXh0ZXJuYWxfcHJpY2VzIjpmYWxzZX0sIm93bmVyIjp7ImlkIjoiZ09xelpoWnJtUSIsInR5cGUiOiJDdXN0b21lciJ9LCJzY29wZSI6Im1hcmtldDo1OCIsImV4cCI6MTcxMDk1NzYzMCwidGVzdCI6dHJ1ZSwicmFuZCI6MC45MzMzMzg0ODA2MzUxODksImlhdCI6MTcxMDk0MzIzMCwiaXNzIjoiaHR0cHM6Ly9jb21tZXJjZWxheWVyLmlvIn0.DC-XTnNf8i-4yWFq3SsVJEuDDIwXnKK6ALWw0vzizYlMb9tRk100TCcgaWiicmC86YuUmS3fsNt2d2rC9f_cE3CxBqwg8ncaSGore59pWBHMH45e6M2DR09K2oFzQk4ZJf3pngqydo_N9Ds6xGZW7vIff9Ga247pAu3-FSahjvhpKXMDkdYB769VGctYOlT1Xz1KCwB0JVpLjr7AR2i8S6R8GAdV3-YNUF_KzYm7qz0jmp7_guqUkYURHSugu9kXMkvUmb6KpyrpW-YBeE789TDra6dXK29WeEtq_nkBZKNmgPOfEEdM2RegmzEFpZNdanbtj__B_i-axqjnJ5lqMQ"
